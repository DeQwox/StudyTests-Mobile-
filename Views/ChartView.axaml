<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.Avalonia;assembly=LiveChartsCore.SkiaSharpView.Avalonia"
             x:Class="OnlineTestingClient.Views.ChartView">
  <Grid RowDefinitions="*,*">
      <!-- Student View: Chart -->
      <lvc:CartesianChart Grid.Row="0" Series="{Binding Series}"
                          XAxes="{Binding XAxes}"
                          YAxes="{Binding YAxes}"
                          TooltipPosition="Top" 
                          IsVisible="{Binding IsStudent}"/>

      <!-- Student View: DataGrid -->
      <DataGrid Grid.Row="1" ItemsSource="{Binding StudentPassedTests}"
                IsVisible="{Binding IsStudent}"
                AutoGenerateColumns="False"
                IsReadOnly="True"
                GridLinesVisibility="All"
                BorderThickness="1" BorderBrush="Gray"
                Margin="0,10,0,0">
          <DataGrid.Columns>
              <DataGridTextColumn Header="Назва тесту" Binding="{Binding TestName}" Width="*"/>
              <DataGridTextColumn Header="Оцінка" Binding="{Binding Score}" Width="Auto"/>
              <DataGridTextColumn Header="Дата" Binding="{Binding PassedAt, StringFormat='{}{0:g}'}" Width="Auto"/>
          </DataGrid.Columns>
      </DataGrid>
      
      <!-- Teacher View: DataGrid -->
      <DataGrid Grid.RowSpan="2" ItemsSource="{Binding TeacherPassedTests}"
                IsVisible="{Binding IsTeacher}"
                AutoGenerateColumns="False"
                IsReadOnly="True"
                GridLinesVisibility="All"
                BorderThickness="1" BorderBrush="Gray">
          <DataGrid.Columns>
              <DataGridTextColumn Header="Назва тесту" Binding="{Binding TestName}" Width="*"/>
              <DataGridTextColumn Header="Студент" Binding="{Binding StudentName}" Width="*"/>
              <DataGridTextColumn Header="Оцінка" Binding="{Binding Score}" Width="Auto"/>
              <DataGridTextColumn Header="Дата" Binding="{Binding PassedAt, StringFormat='{}{0:g}'}" Width="Auto"/>
          </DataGrid.Columns>
      </DataGrid>

      <TextBlock Grid.RowSpan="2" Text="{Binding ErrorMessage}" Foreground="Red" HorizontalAlignment="Center" VerticalAlignment="Center" IsVisible="{Binding HasError}"/>
      
      <TextBlock Grid.RowSpan="2" Text="Статистика поки відсутня." Foreground="Gray" FontSize="18" 
                 HorizontalAlignment="Center" VerticalAlignment="Center" IsVisible="{Binding IsEmpty}"/>
                          
      <Border Grid.RowSpan="2" Background="#AA000000" IsVisible="{Binding IsLoading}">
        <Border HorizontalAlignment="Center" VerticalAlignment="Center" Background="#1F2937" Padding="40" CornerRadius="16">
            <StackPanel Spacing="10">
                <TextBlock Text="Завантаження статистики..." Foreground="White" HorizontalAlignment="Center"/>
                <ProgressBar IsIndeterminate="True" Width="100"/>
            </StackPanel>
        </Border>
      </Border>
  </Grid>
</UserControl>